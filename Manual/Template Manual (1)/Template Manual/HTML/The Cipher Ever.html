<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>The Cipher Ever — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }

        ul{ margin-top: 0.5em; }

        .page-footer::before { content: 'Page '; }
        .page-footer::after { content: ' of 4'; }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">The Cipher Ever</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Module Name.svg" class="diagram">
                <h2>On the Subject of The Cipher Ever</h2>
                <p class="flavour-text">The Metropolitan Line has never been stronger!</p>
                
                <p>This module contains 3 screens, a keyboard, 2 arrows, and a submit button 
                    that displays the current page you're on.</p>

                <p>To disarm the module, first help the module get to its destination, then decrypt
                     a word which has been encrypted using the three following ciphers.</p>

                <h3>Step 1: Wayfinding</h3>

                <p>Initially, only one page will be accessible as the rest will be locked.
                     To unlock the remaining pages, please guide the module along its journey
                      on the Tube this evening.</p>

                <p>The top and middle screens will display the origin and destination stations,
                     respectively. Due to ongoing strike action, the module requests that two
                      routes are provided should one be inaccessible. The first of these routes
                       should contain exactly one interchange*, while the second should contain
                        exactly two. 
                </p>
                
                <p>To submit your routes, type the name of the interchange used in the first route,
                     then press <b>"TO THE TRAINS"</b> submit button (or ENTER on your keyboard). Repeat for
                      the first and then the second interchange used in the second route. A correct
                    submission will unlock the module - proceed to step 2.</p>

                <u>Rules for submission:</u>

                <ul>
                    <li>A route may not use the same line more than once (but the two routes 
                        may share between each other).</li>
                    <li>The module will not accept routes using the DLR, Elizabeth Line, London
                         Overground, London Trams, Cable Car, or Thameslink services as these
                          are not part of the Tube (despite being on the "Tube Map").</li>
                    <li>You must use three different interchanges across both routes.</li>
                </ul>
            
                <u>Notes:</u>

                <ul>
                    <li>It is not possible to type an ampersand (&) into the module; type "N" instead.</li>
                    <li>Similarly, insert a space instead of hyphens, so "BROMLEY-BY-BOW" becomes "BROMLEY BY BOW".</li>
                    <li>Only the interchanges themselves need to be submitted, not the lines taken.</li>
                    <li>There may be multiple possible routes.</li>
                    <li>On an incorrect submission, valid routes will turn green while invalid ones will
                        turn red and a strike will be issued.</li>
                    <li>If a station name is not recognised, it will turn orange but a strike will not 
                        be issued.</li>
                </ul>

                *An interchange is a station you used to change lines <u>on this module</u>.

            </div>
            <div class="page-footer relative-footer">1</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">The Cipher Ever</span>
            </div>
            <div class="page-content">
                <u>Map disambiguation:</u>
                <p>In general, stations connected by solid white lines (labelled "Internal Interchage" in the Key)
                are the same station. This section of the manual exists to clear up ambiguous cases:</p>
                <ul>
                    <li>On the Northern Line, the station between Old Street and Bank is Moorgate.</li>
                    <li>The station where the Central Line connects with the Circle, Hammersmith & City,
                        and Metropolitan Lines is Liverpool Street.
                    </li>
                    <li>Finsbury Park is on both the Piccadilly and Victoria Lines.</li>
                </ul>

                <h3>Step 2: The London Underground Cipher</h3>
                <p>The rest of the module will now unlock. The pages relevant for this section of 
                    the manual are pages 2 and 3; page 2 will show the encrypted word on the top 
                    and the Tube lines the module used for the first route on the other two screens,
                     and page 3 will show the lines used for the second route.
                </p>

                <h4>Step 2.1: Tube Line Transposition</h4>
                <table style="float:left; width:20%; font-size:13px; margin-right:25px"> 
                    <caption>Table A: Tube Colour Index</caption>
                    <tr><th>Index</th><th>Tube Line</th><th>Colour Code</th></tr>
                    <tr><th>0</th><th style="background-color:#B36305;color:white">Bakerloo</th><td>#B36305</td></tr>
                    <tr><th>1</th><th style="background-color:#E32017;color:white">Central</th><td>#E32017</td></tr>
                    <tr><th>2</th><th style="background-color:#FFD300">Circle</th><td>#FFD300</td></tr>
                    <tr><th>3</th><th style="background-color:#00782A;color:white">District</th><td>#00782A</td></tr>
                    <tr><th>4</th><th style="background-color:#F3A9BB">Hammersmith & City</th><td>#F3A9BB</td></tr>
                    <tr><th>5</th><th style="background-color:#A0A5A9">Jubilee</th><td>#A0A5A9</td></tr>
                    <tr><th>6</th><th style="background-color:#9B0056;color:white">Metropolitan</th><td>#9B0056</td></tr>
                    <tr><th>7</th><th style="background-color:#000000;color:white">Northern</th><td>#000000</td></tr>
                    <tr><th>8</th><th style="background-color:#003688;color:white">Piccadilly</th><td>#003688</td></tr>
                    <tr><th>9</th><th style="background-color:#0098D4;color:white">Victoria</th><td>#0098D4</td></tr>
                    <tr><th>10</th><th style="background-color:#95CDBA">Waterloo & City</th><td>#95CDBA</td></tr>
                </table>

                <p>Concatenate the colour codes of these lines (see Table A; omit the # in each code), in the order shown on the
                     module, and shift the resulting string to the right by the absolute difference in
                     the total number of stations in the two routes.
                </p>

                <p>Separate the string back into five 6-digit hexadecimal numbers. Add the first two numbers together
                    to create <b>Key 1</b>, and add the remaining three numbers together to create <b>Key 2</b>.
                </p>

                <p>
                    If <b>Key 1</b> and <b>Key 2</b> have the same parity (even or odd) then append <b>Key 2</b>
                    to <b>Key 1</b>; otherwise append <b>Key 1</b> to <b>Key 2</b>. Discard all characters after
                    the <b>X</b>th character, where <b>X</b> is the number of letters in the encrypted word.
                    This is the <b>Transposition Key</b>. 
                </p>

                <p> Place the encrypted word underneath the <b>Transposition Key</b>, and pair up each letter
                    of the encrypted word with the character in the same position in the <b>Transposition Key</b>,
                    then rearrange the pairs so that the <b>Transposition Key</b> is in numerical order (the numbers
                    going from 0-9 followed by the letters A-F). Decide ties based on original position in reading order.
                </p>
            </div>
            <div class="page-footer relative-footer">2</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">The Cipher Ever</span>
            </div>
            <div class="page-content">
                <h4>Step 2.2: Compacted Trainfair Cipher</h4>

                <p> GENERAL IDEA:s
                    Playfair, but use every pair of consecutive letters (encrypt right to left, decrypt left to right).
                    Additionally, after every use of the grid, shift a row/column based on the unused lines in wayfinding step.
                </p>

                <table style="float:left">
                    <tr><td class="corner"></td><th style="background-color:#00782A;color:white">3</th><th style="background-color:#9B0056;color:white">6</th>
                        <th style="background-color:#F3A9BB">4</th><th style="background-color:#B36305;color:white">0</th><th style="background-color:#A0A5A9">5</th></tr>
                    <tr><th style="background-color:#E32017;color:white">1</th><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr>
                    <tr><th style="background-color:#003688;color:white">8</th><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr>
                    <tr><th style="background-color:#0098D4;color:white">9</th><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr>
                    <tr><th style="background-color:#FFD300">2</th><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr>
                    <tr><th style="background-color:#000000;color:white">7</th><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">3</div>
        </div>


        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">The Cipher Ever</span>
            </div>
            <div class="page-content">
                <h3>Step 3: GoodHood Cipher</h3>
                <p>This step will require the encrypted keyword from the top screen of page 4 and the encrypted text on the middle 
                    screen on the same page.
                </p>
                <h4>Step 3.1: AYO Keyword Transposition</h4>
                <p>First, you will need to decrypt the keyword on the top screen of page 4.</p>
                <p>To do this, place this key below the encrypted keyword:</p>
                <p style="text-align:center;font-size: large;"> AOYYOAAOAYOY </p>
                <p>Take the encrypted keyword letter corresponding to the first A from left to right followed by the one corresponding to the second A e.t.c. Do the same
                    for the Ys and Os aswell.
                </p>
                <p>Caesar cipher this ordered key forwards by the number of batteries on the bomb.</p>
                <p>Look at the letter in the <i>n</i>'th position where <i>n</i> is number of ports modulo 7. Extract this letter and the next 5 letters.</p> 
                <p>You should now have the keyword for this step.</p>
                <h4>Step 3.2: Liemuh Shifting Cipher</h4>
                <p>Start with LLLLLL.</p>
                <p>For each letter of the serial number and your L string, do the following:</p>
                <ul>
                    <li>Check if this serial number character is even or odd. Convert letters to their numeric value (A1Z26).</li>
                    <li>Caesar shift the L forwards if it's even and backwards if it's odd by the alphanumeric value of the serial number character.</li>
                </ul>

                <p>Now you should have an encrypted word ready to decrypt.</p>
                
            </div>
            <div class="page-footer relative-footer">4</div>
        </div>
    </div>
</body>
</html>